/* ********************************************************************************
 * The content of this file is subject to the ParsVT.com Modules License("License");
 * You may not use this file except in compliance with the License
 * The Initial Developer of the Original Code is ParsVT.com
 * Portions created by ParsVT.com. are Copyright(C) ParsVT Team
 * All Rights Reserved.
 * ****************************************************************************** */
Settings_Vtiger_List_Js("Settings_ParsVT_SettingsLog_Js",{registerEventforShowResponse:function(t){jQuery.each(["data"],(function(e,n){var a=jQuery("#"+n+"_value_"+t).val();if(0===jQuery(".jsoncontent#"+n+"_value_"+t).length)jQuery("#"+n+"_result_"+t).html(a);else{try{var g=JSON.parse(a)}catch(e){jQuery("#"+n+"_result_"+t).val(a)}new PrettyJSON.view.Node({el:jQuery("#"+n+"_result_"+t),data:g,level:2})}}))},viewLog:function(t){var e=this;app.helper.showProgress();var n={module:"ParsVT",action:"Fields",mode:"viewSettingsLog",record:t};app.request.post({data:n}).then((function(n,a){null==n&&(app.helper.showModal(a),app.helper.hideProgress(),$(".myModal").on("shown.bs.modal",(function(){setTimeout((function(){e.registerEventforShowResponse(t)}),1e3)})))}))}},{initializePaginationEvents:function(){var t=this,e=this.getComponentInstance("Vtiger_Pagination_Js"),n=t.getListViewContainer();e.initialize(n),app.event.on(e.nextPageButtonClickEventName,(function(){var t=n.find("#pageLimit").val(),e=n.find("#noOfEntries").val(),a=n.find("#nextPageExist").val(),g=n.find("#pageNumber").val(),l=parseInt(parseFloat(g))+1;if(e===t&&a){n.find("#pageNumber").val(l),g=n.find("#pageNumber").val();var s=n.find('[name="orderBy"]').val(),i=n.find('[name="sortOrder"]').val(),o=(n.find("#appName").val(),{});$("#settingslog_changedon").length>0&&""!=$("#settingslog_changedon").val()&&(o.changedon=$("#settingslog_changedon").val()),$("#settingslog_ip").length>0&&""!=$("#settingslog_ip").val()&&(o.ip=$("#settingslog_ip").val()),$("#settingslog_data").length>0&&""!=$("#settingslog_data").val()&&(o.data=$("#settingslog_data").val()),$("#settingslog_module").length>0&&""!=$("#settingslog_module").val()&&(o.module=$("#settingslog_module").val()),$("#settingslog_url").length>0&&""!=$("#settingslog_url").val()&&(o.url=$("#settingslog_url").val()),$("#settingslog_whodid").length>0&&""!=$("#settingslog_whodid").val()&&(o.whodid=$("#settingslog_whodid").val());var r={module:"ParsVT",parent:"Settings",page:g,view:"SettingsLog",orderby:s,sortorder:i,search_params:JSON.stringify(o)};return window.location.href="index.php?"+$.param(r),!0}})),app.event.on(e.previousPageButtonClickEventName,(function(){var t=n.find("#pageNumber").val(),e=parseInt(parseFloat(t))-1;if(t>1){n.find("#pageNumber").val(e),t=n.find("#pageNumber").val();var a=n.find('[name="orderBy"]').val(),g=n.find('[name="sortOrder"]').val(),l=(n.find("#appName").val(),{});$("#settingslog_changedon").length>0&&""!=$("#settingslog_changedon").val()&&(l.changedon=$("#settingslog_changedon").val()),$("#settingslog_ip").length>0&&""!=$("#settingslog_ip").val()&&(l.ip=$("#settingslog_ip").val()),$("#settingslog_data").length>0&&""!=$("#settingslog_data").val()&&(l.data=$("#settingslog_data").val()),$("#settingslog_module").length>0&&""!=$("#settingslog_module").val()&&(l.module=$("#settingslog_module").val()),$("#settingslog_url").length>0&&""!=$("#settingslog_url").val()&&(l.url=$("#settingslog_url").val()),$("#settingslog_whodid").length>0&&""!=$("#settingslog_whodid").val()&&(l.whodid=$("#settingslog_whodid").val());var s={module:"ParsVT",parent:"Settings",page:t,view:"SettingsLog",orderby:a,sortorder:g,search_params:JSON.stringify(l)};return window.location.href="index.php?"+$.param(s),!0}})),app.event.on(e.pageJumpButtonClickEventName,(function(e,n){t.pageJump()})),app.event.on(e.totalNumOfRecordsButtonClickEventName,(function(e,n){t.totalNumOfRecords(n)})),app.event.on(e.pageJumpSubmitButtonClickEvent,(function(e,n){t.pageJumpOnSubmit(n)}))},pageJumpOnSubmit:function(t){var e=this.getListViewContainer(),n=e.find("#pageNumber"),a=parseInt(n.val()),g=parseInt(e.find("#pageToJump").val());if(g>parseInt(e.find("#totalPageCount").text())){var l=app.vtranslate("JS_PAGE_NOT_EXIST");app.helper.showErrorNotification({message:l})}else if(g!==a){t.closest(".btn-group ").removeClass("open");var s=e.find('[name="orderBy"]').val(),i=e.find('[name="sortOrder"]').val(),o={};$("#settingslog_changedon").length>0&&""!=$("#settingslog_changedon").val()&&(o.changedon=$("#settingslog_changedon").val()),$("#settingslog_ip").length>0&&""!=$("#settingslog_ip").val()&&(o.ip=$("#settingslog_ip").val()),$("#settingslog_data").length>0&&""!=$("#settingslog_data").val()&&(o.data=$("#settingslog_data").val()),$("#settingslog_module").length>0&&""!=$("#settingslog_module").val()&&(o.module=$("#settingslog_module").val()),$("#settingslog_url").length>0&&""!=$("#settingslog_url").val()&&(o.url=$("#moduleName").val()),$("#settingslog_whodid").length>0&&""!=$("#settingslog_whodid").val()&&(o.whodid=$("#settingslog_whodid").val());var r={module:"ParsVT",parent:"Settings",page:g,view:"SettingsLog",orderby:s,sortorder:i,search_params:JSON.stringify(o)};window.location.href="index.php?"+$.param(r)}else{l=app.vtranslate("JS_YOU_ARE_IN_PAGE_NUMBER")+" "+g;app.helper.showAlertNotification({message:l})}},getPageJumpParams:function(){var t=app.getModuleName(),e=app.getParentModuleName(),n={};return $("#settingslog_changedon").length>0&&""!=$("#settingslog_changedon").val()&&(n.changedon=$("#settingslog_changedon").val()),$("#settingslog_ip").length>0&&""!=$("#settingslog_ip").val()&&(n.ip=$("#settingslog_ip").val()),$("#settingslog_data").length>0&&""!=$("#settingslog_data").val()&&(n.data=$("#settingslog_data").val()),$("#settingslog_module").length>0&&""!=$("#settingslog_module").val()&&(n.module=$("#settingslog_module").val()),$("#settingslog_url").length>0&&""!=$("#settingslog_url").val()&&(n.url=$("#settingslog_url").val()),$("#settingslog_whodid").length>0&&""!=$("#settingslog_whodid").val()&&(n.whodid=$("#settingslog_whodid").val()),{module:t,parent:e,view:"SettingsLogAjax",mode:"getPageCount",search_params:n}},registerSensitiveListViewSearch:function(){var t=this.getListViewContainer(),e=app.getModuleName(),n=app.getParentModuleName();t.on("click",'[data-trigger="settingslog_listSearch"]',(function(t){t.preventDefault();var a={};$("#settingslog_changedon").length>0&&""!=$("#settingslog_changedon").val()&&(a.changedon=$("#settingslog_changedon").val()),$("#settingslog_ip").length>0&&""!=$("#settingslog_ip").val()&&(a.ip=$("#settingslog_ip").val()),$("#settingslog_data").length>0&&""!=$("#settingslog_data").val()&&(a.data=$("#settingslog_data").val()),$("#settingslog_module").length>0&&""!=$("#settingslog_module").val()&&(a.module=$("#settingslog_module").val()),$("#settingslog_url").length>0&&""!=$("#settingslog_url").val()&&(a.url=$("#settingslog_url").val()),$("#settingslog_whodid").length>0&&""!=$("#settingslog_whodid").val()&&(a.whodid=$("#settingslog_whodid").val());var g={module:e,parent:n,view:"SettingsLog",page:"1",search_params:JSON.stringify(a)};window.location.href="index.php?"+$.param(g)})),t.on("click",'[data-trigger="settingslog_ClearSearch"]',(function(t){t.preventDefault();var a={module:e,parent:n,view:"SettingsLog"};window.location.href="index.php?"+$.param(a)}))},registerEvents:function(){this._super(),this.registerSensitiveListViewSearch()}});
