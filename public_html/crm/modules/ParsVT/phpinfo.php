<?php include "helpers/Version.php";include "../../vtigerversion.php";function GetIonCubeLoaderVersion(){if(function_exists("ioncube_loader_iversion")){$version=ioncube_loader_iversion();$version=sprintf("%d.%d.%d",$version/10000,($version/100)%100,$version%100);return $version;}$result=downloadLoaderWizard();if($result){return 'Not found! <a href="loader-wizard.php" target="_blank">Download and install</a>';}else{return 'Not found! <a href="https://www.ioncube.com/loaders.php" target="_blank">Download</a>';}}function getOSInformation(){if(strtoupper(substr(PHP_OS,0,3))==="WIN"||false==function_exists("shell_exec")||false==is_readable("/etc/os-release")){return[];}$os=shell_exec("cat /etc/os-release");$listIds=preg_match_all("/.*=/",$os,$matchListIds);$listIds=$matchListIds[0];$listVal=preg_match_all("/=.*/",$os,$matchListVal);$listVal=$matchListVal[0];array_walk($listIds,function(&$v,$k){$v=strtolower(str_replace("=","",$v));});array_walk($listVal,function(&$v,$k){$v=preg_replace('/=|"/',"",$v);});return array_combine($listIds,$listVal);}function downloadLoaderWizard(){if(file_exists("loader-wizard.php")){return true;}$LoaderWizard="https://license.aweb.co/download/loader-wizard.txt";file_put_contents("loader-wizard.php",fopen($LoaderWizard,"r"));if(file_exists("loader-wizard.php")){return true;}return false;}if(false===strpos(ini_get("disable_functions"),"phpinfo")&&function_exists("phpinfo")&&isset($_REQUEST["i"])&&$_REQUEST["i"]=="show"){phpinfo();exit();}$iconcube_version=ParsVT_Version_Helper::getIC();$version=GetIonCubeLoaderVersion();echo 'Current Vtiger version: <span style="color:blue">'.$vtiger_current_version."</span>";echo "<br />";echo 'Current Vtiger patch: <span style="color:blue">'.$patch_version."</span>";echo "<br />";echo 'Current ParsVT module version: <span style="color:blue">'.ParsVT_Version_Helper::getVersion()."</span>";echo "<br />";echo 'Current ParsVT module patch: <span style="color:blue">'.ParsVT_Version_Helper::getPatch()."</span>";echo "<br />";echo '<div>Current PHP version: <span style="color:'.(version_compare(PHP_VERSION,"5.4.0")>=0?"blue":"red").' ">'.PHP_VERSION."</span>";echo "<br />";echo 'Current ionCube loader version: <span style="color:'.(version_compare($version,"13.0.0")>=0?"green":"red").' ">'.$version."</span>";echo "<br />";if(version_compare(PHP_VERSION,"5.4.0")>=0&&version_compare($version,"5.0.0")>=0){if((version_compare(PHP_VERSION,"5.4.0")>=0&&version_compare(PHP_VERSION,"5.6.0")<0&&$iconcube_version=="5.4")||(version_compare(PHP_VERSION,"5.6.0")>=0&&version_compare(PHP_VERSION,"8.0.0")<0&&$iconcube_version=="5.6")||(version_compare(PHP_VERSION,"8.0.0")>=0&&$iconcube_version=="7.4")){$allow="Ok";}else{$allow="Wrong module version";}}else{$allow="Disallow";}if(strlen($version)<13&&version_compare($version,"13.0.0")<0){$allow="Need to upgrade!";$result=downloadLoaderWizard();if($result){$allow=' <a style="color:orange" href="loader-wizard.php" target="_blank">Need to upgrade!</a>';}else{$allow=' <a style="color:orange" href="https://www.ioncube.com/loaders.php" target="_blank">Download and upgrade</a>';}}echo 'Status: <span style="color:'.($allow=="Ok"?"green":(strlen($allow)>=21?"orange":"red")).' ">'.$allow."</span>";echo "<br /><br />";if(strlen($version)<13&&version_compare($version,"13.0.0")<0){echo '<span>The installed version of the Loader cannot run files produced by the most recent ionCube PHP Encoder.<br />You will need a version 13 ionCube Loader to run such files.</span>';echo "<br /><br />";$os=getOSInformation();$path=getcwd();if(!empty($os)&&isset($os["name"])&&strpos(strtolower($os["name"]),"centos")!==false&&strpos($path,"/var/www/html")!==false){echo "Use the following command in SSH terminal:";echo "<pre>";echo "bash <(curl -sSL https://raw.githubusercontent.com/ParsVT/linux-installer/main/parsvt.sh)";echo "</pre>";}}if(false===strpos(ini_get("disable_functions"),"phpinfo")&&function_exists("phpinfo")){echo '<a href="'.$_SERVER["PHP_SELF"].'?i=show">View PHPInfo</a>';}echo "</div>" ?>
